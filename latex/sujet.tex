\documentclass[a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphics}
\usepackage{libertine}
\usepackage{tango}
%\usepackage[colorlinks=true]{hyperref}

\hypersetup{urlcolor=DarkChocolate}

\title{TP Git}
%\author{\scalebox{0.35}{ \includegraphics{logo_azae}}}
\author{Thomas Clavier}
\date{}

\setlength{\parindent}{0pt}
\newcounter{question}
\setcounter{question}{1}
\newcommand{\q}{
  \textcolor{DarkOrange}{\textbf{Question \thequestion : }}
  \addtocounter{question}{1}
  \newline
}

\begin{document}

\maketitle

\section{configuration}

Configurez votre nom (user.name) votre email (user.email) et le serveur mandataire (http.proxy) dans git. 

\section{L'espace de travail}

À partir de là nous allons construire un blog de promotion.

\subsection{Initialisation}
Créez un répertoire de travail et initialisez le comme un dépôt git local.

\subsection{Historique de version}
Dans ce blog, tous les articles sont rédigé en utilisant le format Markdown (\url{http://daringfireball.net/projects/markdown/syntax}).

\subsubsection{Premier changement}
Dans l'espace de travail que vous avez initialisez comme dépôt local, créez un sous répertoire <<content>>.

Avec votre voisin choisissez un sujet, puis créez le même article <<content/[votre-sujet].md>> chacun dans votre dépôt local avec le contenu suivant : 

\begin{verbatim}
+++
date = "2015-03-10T12:00:00+01:00"
draft = true
title = "le sujet"

+++

# Le premier titre
\end{verbatim}

Vous pouvez par exemple faire un article avec les réponses à ce TP.

L'ajouter dans l'index comme fichier à suivre, puis validez le changement et enfin observez l'historique des changements, quelles sont les informations disponibles ? À quoi correspond chaque champ ?

\subsubsection{Second changement}
Ajoutez quelques informations dans votre article puis validez un nouveau commit.

Comment obtenir le diff entre les 2 derniers commits ?

\subsubsection{Suppression}
Créez un article <<content/satoshi-tajiri.md>> puis validez un nouveau commit. 
Supprimez l'article <<content/satoshi-tajiri.md>> puis validez un nouveau commit. 

Que voit-on dans l'historique ?

\section{Partager}

\subsection{Via un dépôt partagé}

Indiquons à Git que nous souhaitons échanger des données avec le dépôt distant suivant : http://git.iut.azae.net/git/tp-git.git
Nous appelons ce dépôt <<origin>>.

Puis envoyez l'ensemble des modifications de la branche courante (master) vers le dépôt <<origin>>

Que se passe-t-il ?

Visitez \url{http://git.iut.azae.net/} pour admirer votre travail.

Expliquez le résultat de la commande suivante : 
\begin{verbatim}
git log --oneline --graph --decorate
\end{verbatim}

Si l'on souhaite obtenir une copie de travail d'un dépôt distant existant il est possible d'utiliser la commande :
\begin{verbatim}
git clone url
\end{verbatim}

Quelles sont les formes d'URL possibles ?

Lançons la génération des pages html : 
\begin{verbatim}
./bin/hugo --theme=hyde --buildDrafts
\end{verbatim}

Que donne la commande suivante ? Pourquoi ? 
\begin{verbatim}
git status
\end{verbatim}

Est-il normale d'enregistrer du code généré ? 

Pour ignorer tout le répertoire de génération modifions le fichier .gitignore
\begin{verbatim}
gedit .gitignore
\end{verbatim}

Enregistrez et partagez vos modifications, que se passe-t-il ? 

\section{Gérer le code}

Pour identifier un commit avec un nom facile à retenir, il est possible de poser un tag. C'est par exemple utilisé pour marquer une version donnée.

\subsection{Des branches}

Pour gérer plusieurs versions de l'ensemble du code en parallèle, Git propose de faire des <<branches>>.

\begin{itemize}
  \item Ajoutez une branche "nom-prenom-merge", 
  \item dans cette branche modifiez votre article (en fin de fichier), puis validez le commit (faire au moins 2 modifications et 2 commits). 
  \item Revenez sur la branche master, 
  \item faites 2 modifications en début de fichiers (avec 2 commits) 
  \item puis fusionnez la branche "nom-prenom-merge" avec master.
\end{itemize}

Observez le résultat dans l'arbre des versions. 
\begin{verbatim}
git log --graph --oneline --all
\end{verbatim}

Expliquer ce qui c'est passé.

\begin{itemize}
  \item Ajoutez une branche "nom-prenom-rebase", 
  \item dans cette branche modifiez votre article (en fin de fichier), puis validez votre commit (faire au moins 2 modifications et 2 commits). 
  \item Revenez sur la branche master, 
  \item et faites à nouveau 2 modifications en début de fichier (avec 2 commits) 
  \item puis <<rebasez>>.
\end{itemize}

Observez le résultat dans l'arbre des versions. 
\begin{verbatim}
git log --graph --oneline --all
\end{verbatim}

Expliquez ce qui c'est passé.

\section{Plus loin}

Expliquez chacune des commandes suivantes :
\begin{verbatim}
git log --graph --pretty=format:\
'%Cred%h%Creset -%C(yellow)%d%Creset \
%s %C(bold blue)<%an>%Creset%n' --abbrev-commit --all
git stash 
git stash pop
git bisect
git staged
git unstage
git fix 
git blame 
git format-patch
git send-email
git archive
git revert
\end{verbatim}

\end{document}

